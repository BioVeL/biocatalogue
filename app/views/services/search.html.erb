<%

# BioCatalogue: app/views/services/search.html.erb
#
# Copyright (c) 2008, University of Manchester, The European Bioinformatics 
# Institute (EMBL-EBI) and the University of Southampton.
# See license.txt for details

%>

<% if @query.blank? %>
	<% t "Search" -%>
	<h1>Search Services</h1>
<% else %>
	<% t "Search Results for '#{h(@query)}'" -%>
	<h1>Search Results</h1>
<% end %>

<div>
	
	<div class="search_box" style="float:right; margin-left: 2em;">
		<% rounded "#e9f7cc", "#333", "auto" do %>
			<% form_tag(search_services_url, :method => :get) do %>
			  <b>Search services:</b>
				<%= text_field_tag :q, @query || params[:q], :id => "services_search_page_search_field", :size => 30, :autocomplete => "off" -%>
				
				<div class="auto_complete" id="services_search_page_auto_complete"></div>
				
				<%= auto_complete_field "services_search_page_search_field",
						:update => "services_search_page_auto_complete",
						:url => search_auto_complete_url -%>
						
			  <%= submit_tag '', :class => "search_button" -%>
			<% end %>
		<% end %>
	</div>
	
	<% if @query.blank? %>
		<p>
			<%= search_provide_query_text -%>
		</P>
	<% else %>
		<% unless @results.nil? %>
			<p>
				Search query:
				"<b><%= h @query -%></b>"
				returned <%= pluralize(@results.total, "services") -%>
			</p>
		<% end %>
	<% end %>
	
</div>

<br/>

<% unless @query.blank? %>

	<% if @results.nil? or @results.total == 0 %>
	
	  <p class="none_text">No services found</p>
	  
	<% else %>
	
		<% 
			 result_type = "services"
			 item_ids = @results.item_ids(result_type, params[:page])
			 items = search_item_ids_to_objects(item_ids, result_type)
		 %>
		
		<%= render :partial => 'widgets/pagination_top', :locals => { :paginated_items => item_ids, :entry_name => 'service' } %>
		
		<div id="search_results" style="margin: 2em 0;">
			<%= render :partial => "services/listing", :locals => { :items => items } %>
		</div>
			
		<%= render :partial => 'widgets/pagination_bottom', :locals => { :paginated_items => item_ids } %>
	
	<% end %>

<% end %>

<br />

