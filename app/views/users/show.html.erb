<%

# BioCatalogue: app/views/users/show.html.erb
#
# Copyright (c) 2008, University of Manchester, The European Bioinformatics 
# Institute (EMBL-EBI) and the University of Southampton.
# See license.txt for details

%>

<% t "#{h @user.display_name}" -%>

<h1>User: <span class="orange_highlight"><%=h @user.display_name %></span></h1>

<br/>

<div id="user-tabs" class="tabber">
	
  <div id="tab-profile" class="tabbertab">
    <h3>Profile</h3>
    <p>
      <b>Display Name:</b>
      <%=h @user.display_name %>
    </p>
    
    <p>
      <% if mine?(@user) -%>
      <b>Email:</b>
      <%=h @user.email %>
      <% end -%>
    </p>
    
    <p>
      <b>Affiliation:</b>
      <%=h @user.affiliation %>
    </p>
    
    <p>
      <b>Country:</b>
      <%=h @user.country %>
    </p>

    <% if mine?(@user) -%>
    <p><br />
      <%= link_to 'Edit my profile', edit_user_path(@user), :class => "edit_profile" %>
      <%= link_to 'Change my password', change_password_user_path(@user), :class => "change_pwd" %>
    </p>
    <% end -%>
    
  </div>
  
  <div id="tab-services" class="tabbertab">
    <h3><%= "Services submitted (#{@users_services.total_entries})" -%></h3>
    
		<%= render :partial => 'widgets/pagination_top', :locals => { :paginated_items => @users_services } %>
		
		<div id="users_services" style="margin: 1em 0;">
			<%= render :partial => "services/listing", :locals => { :items => @users_services } %>
		</div>
		
		<%= render :partial => 'widgets/pagination_bottom', :locals => { :paginated_items => @users_services } %>
  </div>
	
	<div id="tab-favourites" class="tabbertab">
		<% favourites = @user.favourites %>
		
		<h3><%= "Favourites (#{favourites.length})" -%></h3>
		
		<% unless favourites.empty? %>
			<% favourites.each do |f| %>
				<%= render :partial => "#{f.favouritable_type.pluralize.downcase}/listing", :locals => { :items => [ f.favouritable ] }  -%>
				
				<p style="text-align: right; margin: 0 0 2em 0;">
					<% if mine?(f) -%>
						<%= link_to(image_tag(icon_filename_for(:delete), :style => 'vertical-align: middle;') + " <span style='vertical-align: middle;'>Remove from favourites</span>",
	               				favourite_path(f),
	               				:method => :delete,
	               				:confirm => "Are you sure you want to remove this service from your favourites?",
												:title => tooltip_title_attrib("Remove from your favourites"),
												:class => "button_slim") -%>
					<% end -%>
				</p>
			<% end %>
		<% else %>
			<p class="none_text">None</p>
		<% end %>		
	</div>

</div>

<%= render :partial => 'shared/tabber_startup' -%>
