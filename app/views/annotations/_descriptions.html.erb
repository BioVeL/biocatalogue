<%

# BioCatalogue: app/views/annotations/_descriptions.html.erb
#
# Copyright (c) 2008, University of Manchester, The European Bioinformatics 
# Institute (EMBL-EBI) and the University of Southampton.
# See license.txt for details

%>

<%# Set defaults for optional parameters to this partial... %>
<% show_header = true unless local_assigns.has_key?(:show_header) %>
<% truncate_desc = false unless local_assigns.has_key?(:truncate_desc) %>
<% auto_link_desc = true unless local_assigns.has_key?(:auto_link_desc) %>

<% unless annotatable.nil? %>
	<% if show_header == true %>
		<div>
			<%= annotation_add_by_popup_link annotatable,
																			 :attribute_name => "Description",
					                             :tooltip_text => "Click to provide a new description",
					                             :style => "margin-left:1em; float:right;" -%>
			<p>
				<b>Description(s):</b>
			</p>
		</div>
	<% end %>
	
	<div class="box_annotations">
		<% unless (desc = h(annotatable.description)).blank? %>
			<div class="box_annotation_provider">
				<p class="annotation_source_text annotation_source_provider">
					from <b>service description document</b> (<%= distance_of_time_in_words_to_now(annotatable.created_at) -%> ago)
				</p>
				<% desc = truncate(desc, :length => truncate_desc) unless truncate_desc == false %>
				<% desc = auto_link(desc, :all, :target => '_blank') if auto_link_desc == true -%>
				<%= desc -%>
			</div>
		<% end %>
		
		<% annotatable.annotations_with_attribute("description").each do |ann| %>
			<div>
				<%= annotation_source_text(ann) -%>
				<% desc = h(ann.value) %>
				<% desc = truncate(desc, :length => truncate_desc) unless truncate_desc == false %>
				<% desc = auto_link(desc, :all, :target => '_blank') if auto_link_desc == true -%>
				<%= desc -%>
			</div>
		<% end %>
	</div>
<% end %>