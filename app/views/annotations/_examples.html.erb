<%

# BioCatalogue: app/views/annotations/_examples.html.erb
#
# Copyright (c) 2008-2009, University of Manchester, The European Bioinformatics 
# Institute (EMBL-EBI) and the University of Southampton.
# See license.txt for details

%>

<%
	attribute_name = "example"
	main_div_id = "examples_#{rand(10000000)}"
%>

<% unless annotatable.nil? %>
	<div id="<%= main_div_id -%>" class="annotations_container">
		<div style="margin-top: 1em;">
		  <b>Example(s):</b>
		</div>
		
		<div class="box_annotations">
			<% examples_annotations = annotatable.annotations_with_attribute(attribute_name).sort {|a,b| a.created_at <=> b.created_at} %>
			<% unless examples_annotations.empty? %>
				<% examples_annotations.each do |ann| %>
					<% rounded(annotation_text_item_background_color, "#333", "100%") do %>
						<div class="text">
							<div style="padding-bottom: 0.3em; border-bottom: 1px dotted #CCC;">
								<%= annotation_source_text(ann) -%>
								<span>
									<%= link_to(image_tag(icon_filename_for(:open_in_new_window)), download_annotation_url(ann), :popup => true, :title => tooltip_title_attrib("Open this example data in a new window so you can easily save or copy and paste it")) -%>
								</span>
							</div>
							<div style="margin-top: 0.7em;">
								<pre><%= annotation_prepare_description(ann.value, false, nil, false, false) -%></pre>
							</div>
							<% if mine?(ann) %>
								<p class="actions">
									<span><%= annotation_edit_by_popup_link(ann) -%></span>
									<span style="margin-left: 1em;"><%= link_to("delete", annotation_path(ann), :method => :delete, :confirm => "Are you sure you want to delete this example data?", :style => 'vertical-align: middle;')-%></span>
								</p>
							<% end %>
						</div>
					<% end %>
				<% end %>
			<% else %>
				<span class="none_text">None</span>
			<% end %>
		</div>
		
		<% if logged_in? %>
			
			<%= render :partial => "annotations/common/default_add_box",
								 :locals => { :partial_from => "examples",
															:annotatable => annotatable,
															:attribute_name => attribute_name,
															:text_area_default_text => "Add example data...",
															:main_div_id => main_div_id } -%>
		
		<% else %>
			<div class="login_link_box">
				<small><%= link_to("Login to add example data", login_path) -%></small>
			</div>
		<% end %>
	</div>
<% end %>
