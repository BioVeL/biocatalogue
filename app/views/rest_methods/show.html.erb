<%
  
  # BioCatalogue: app/views/rest_methods/show.html.erb
  #
  # Copyright (c) 2009, University of Manchester, The European Bioinformatics 
  # Institute (EMBL-EBI) and the University of Southampton.
  # See license.txt for details
  
%>

<div>
  <%= link_to image_tag(icon_filename_for(:arrow_backward)) + content_tag(:span, " Back To Service \"#{display_name(@rest_service.service)}\""),
						  service_url(@rest_service.service, :anchor => "endpoints"), :class => "button_slim", :style => "margin-right:1.5em;" -%>

	<%= add_endpoints_by_popup(@rest_service, 
                               :style => "float:none;", 
                               :class => "button_slim") %>

</div>

<div class="vtabs_container">
	
  <!-- TABS BAR -->  
  <div class="vtabs_tab_bar" style="width:25%;">
    <ul>
       <% @rest_service.rest_resources.sort.each do |resource| %>
        <% resource.rest_methods.sort.each do |meth| %>
          <li class="<%= meth == @rest_method ? 'active' : '' -%>">
            
            <% label = content_tag(:span, meth.display_endpoint, :class => 'name') + "<br/>" + content_tag(:span, meth.endpoint_name, :class => 'detail') -%>
            <%= link_to  label, meth -%>


          </li>
        <% end %>
      <% end %>
    </ul>
  </div>
   
  <!-- MAIN AREA-->
  <div class="vtabs_tab_content" style=" width:72%;">
    <% resource = @rest_method.rest_resource %>

    <h1>
      Endpoint: <%= h @rest_method.display_endpoint -%>    
      <span class="actions_link_container">
        <%= link_to "Delete", @rest_method,
                              :confirm => "Are you you want to delete this endpoint.  This cannot be undone.", 
                              :method => :delete,
                              :style => "margin-right: 0px; padding:7px;",
                              :class => "delete_link button_slim" if BioCatalogue::Auth.allow_user_to_curate_thing?(current_user, @rest_method) %>
      </span>
    </h1>
    
    <div class="operation_box">        
      <div>
        <div style="float: left; width: 73%;">
          <div style="margin-bottom: 1.2em;">            
            <%= render :partial => "rest_methods/endpoint_name" -%>
          </div>
          
          <div style="margin-bottom: 1.2em;">
           <b>Template:</b>
           <%= create_url_template(@base_endpoint, resource, @rest_method) -%>
          </div>
          
          <div>
            <%= render :partial => "annotations/descriptions",
              :locals => { :annotatable => @rest_method } -%>
          </div>
          
          <div>
            <%= render :partial => "annotations/example_endpoints",
              :locals => { :annotatable => @rest_method } -%>
          </div>
          
          <div>
            <%= render :partial => "annotations/documentation_urls",
                       :locals => { :annotatable => @rest_method } -%>
          </div>

        </div>
          
        <div style="float: right; width: 24%; font-size: 85%; margin-top:10px;">
          <%= render :partial => "annotations/tags_box",
            :locals => { :annotatable => @rest_method } -%>
        </div>
          
        <span class="clear"></span>
      </div>
          
      <br />
      <%= render :partial => "rest_parameters/input_parameters", 
                 :locals => {:method => @rest_method, :resource => resource} -%>

      <%= render :partial => "rest_representations/representation", 
                 :locals => {:method => @rest_method, 
                             :resource => resource,
                             :is_http_request => true} -%>

      <%= render :partial => "rest_representations/representation", 
                 :locals => {:method => @rest_method, 
                             :resource => resource,
                             :is_http_request => false} -%>
      <br/>
    </div>
  </div>
</div>
