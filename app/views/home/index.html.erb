<%

# BioCatalogue: app/views/home/index.html.erb
#
# Copyright (c) 2008, University of Manchester, The European Bioinformatics 
# Institute (EMBL-EBI) and the University of Southampton.
# See license.txt for details

%>

<div id="home_content">
	
	<p id="home_heading">The BioCatalogue: providing a curated catalogue of Life Science Web Services</p>
	
	<div id="middle_column_wrapper">
		<div id="middle_column">
			
			<div id="home-tabs" class="tabber">
	
			  <div id="tab-activity" class="tabbertab">
			    <h3>Activity</h3>
					
					<div id="home_stats_bar">
				    <center>
				    	<% rounded "#E9F7CC", "#333", "auto" do %>
							  The BioCatalogue currently has
							  <strong><%= link_to pluralize(Service.count, "service"), services_path -%></strong>,
								<strong><%= link_to pluralize(ServiceProvider.count, "service provider"), service_providers_path -%></strong> and
							  <strong><%= link_to pluralize(User.count_activated, "member"), users_url -%></strong>
								<%= info_icon_with_tooltip("<b>Members</b> are registered users of the BioCatalogue.<br/><br/>If you would like to sign up for an account and become a member please click on 'Sign Up' towards the top right. <br/><br/>#{sign_up_benefits_text}") -%>
							<% end %>
				    </center>
				  </div>
				</div>
				
				<div id="tab-latest-services" class="tabbertab">
			    <h3>Latest Services</h3>
					
					<%= render :partial => "services/listing", :locals => { :items => Service.latest, :listing_type => :simple } %>
				</div>
				
				<div id="tab-our-goals" class="tabbertab">
			    <h3>Our Goals</h3>
					
		      <ul id="key_points">
						<li>Providing a <em>single registration point</em> for Web Service providers
						  and a <em>single search site</em> for scientists and developers.</li>
						<li>Providers, Expert curators and Users will provide oversight, monitor the catalogue 
						  and provide <em>high quality annotations</em> for services.</li>
						<li>BioCatalogue is a place where the <em>community</em> can find contacts and meet
						  the experts and maintainers of these services.</li>
		      </ul>
				</div>
				
			</div>
			
		</div>
	</div>
	
	<div id="left_column">
		<div class="column_inner">
			<%= image_tag "info_box_discover.png", :alt => "Info box on 'Discover'", :class => "info_image" -%>
			<%= image_tag "info_box_register.png", :alt => "Info box on 'Register'", :class => "info_image" -%>
			<%= image_tag "info_box_annotate.png", :alt => "Info box on 'Annotate'", :class => "info_image" -%>
			<%= image_tag "info_box_monitor.png", :alt => "Info box on 'Monitor'", :class => "info_image" -%>
		</div>
	</div>
	
	<div id="right_column">
		<div class="column_inner">
			
			<div class="section_box">
				<h4>
					<span style="float: right; margin-left: 0.3em;">
						<%= feed_icon_tag "Site Announcements", announcements_path(:format => :atom) -%>
					</span>
					<%= generic_icon_for(:announcements, 'margin-right: 0.4em;') -%>
					<span>Site Announcements</span>
				</h4>
				
				<div class="section_content" style="font-size: 85%;">
					<% unless (announcements = Announcement.latest).empty? %>
						<% announcements.each do |a| %>
							<p style="margin-bottom: 0.7em;">
								<b><%= link_to display_name(a), a -%></b>
								<br/>
								By <%= link_to display_name(a.user), a.user -%>
								<span class="ago">(<%= distance_of_time_in_words_to_now(a.created_at) -%> ago</span>
							</p>
						<% end %>
					<% else %>
						<p class="none_text">None</p>
					<% end %>
				</div>
				
				<div class="section_footer">
					<% if BioCatalogue::Auth.allow_user_to_curate_thing?(current_user, :announcements) %>
						<b><%= link_to "New", new_announcement_url %></b>
						|
					<% end %>
					<b><%= link_to "See All", announcements_url %></b>
				</div>
			</div>
			
			<div class="section_box">
				<h4>
					<%= generic_icon_for(:curators, 'margin-right: 0.4em;') -%>
					<span>Top Curators</span>
				</h4>
				
				<div class="section_content">
					<% unless (top_curators = User.top_curators).empty? %>
						<table id="top_curators">
							<% top_curators.each do |u| %>
								<% user = User.find(u['id'])%>
								<% unless user.nil? %>
									<tr title="<%= tooltip_title_attrib("#{u['name']} has added #{u['count']} annotations to the BioCatalogue") -%>">
										<td class="count">
											<%= number_with_delimiter(u['count']) -%>
										</td>
										<td>
											<%= user_link_with_flag user -%>
										</td>
									</tr>
								<% end %>
							<% end %>
						</table>
					<% else %>
						<p class="none_text">None</p>
					<% end %>
				</div>
			</div>
			
		</div>
	</div>
		
	<span class="clear"></span>
	
	<%= render :partial => 'shared/tabber_startup' -%>
	
	<br/><br/><br/><br/><br/><br/>

  <div style="float: right; width: 600px;">

    <div style="width: 550px; margin: auto; margin-top: 0.5em;">
      <center>
      	<% rounded "#E9F7CC", "#333", "auto" do %>
				  BioCatalogue currently has
				  <strong><%= link_to pluralize(Service.count, "service"), services_path -%></strong> and
				  <strong><%= link_to pluralize(User.count_activated, "member"), users_url -%></strong>
					<%= info_icon_with_tooltip("<b>Members</b> are registered users of the BioCatalogue.<br/><br/>If you would like to sign up for an account and become a member please click on 'Sign Up' towards the top right. <br/><br/>#{sign_up_benefits_text}") -%>
				<% end %>
      </center>
      <p class="home_heading">BioCatalogue: providing a curated catalogue<br />of Life Science Web Services.</p>
    </div>

    <div class="liquid-round" style="width: 500px; margin-top: 3em;">
      <div class="top"><span></span></div>
      <div class="center-content">
				<!-- CONTENT BEGIN -->
				<img class="round_box_title" src="images/search_title.gif" alt="Search for Web Services" />
				<p>
				  The easiest way to <em>find the Web Service</em> you are looking for is to use the BioCatalogue 
				  search functionality below (also available in the action bar at the top of every page).
				</p>
				<p>
				  <div class="search_widget">
				    <% form_tag search_url, :method => :get do %>
					    <b>Search:</b>
							<%= text_field_tag :q, params[:q], :id => "home_search_field", :size => 40, :autocomplete => "off" -%>
							
							<div class="auto_complete" id="home_search_auto_complete"></div>
							
							<%= auto_complete_field "home_search_field",
									:update => "home_search_auto_complete",
									:url => search_auto_complete_url,
									:min_chars => 3 -%>
									
					    <%= submit_tag '', :class => "search_button" -%>
				    <% end %>
				  </div>
				</p>
				<!-- CONTENT END -->
      </div>
      <div class="bottom"><span></span></div>
    </div>

    <div style="width: 550px; margin: auto;">
      <h2>Our goals:</h2>
      <ul id="key_points">
				<li>Providing a <em>single registration point</em> for Web Service providers
				  and a <em>single search site</em> for scientists and developers.</li>
				<li>Providers, Expert curators and Users will provide oversight, monitor the catalogue 
				  and provide <em>high quality annotations</em> for services.</li>
				<li>BioCatalogue is a place where the <em>community</em> can find contacts and meet
				  the experts and maintainers of these services.</li>
      </ul>
    </div>

  </div>

  <div style="float:left; width:270px;">

    <div class="liquid-round" style="width: 260px;">
      <div class="top"><span></span></div>
      <div class="center-content" style="height: 14.5em;">
				<!-- CONTENT BEGIN -->
				<img class="round_box_title" src="images/browse_title.gif" alt="Browse all Web Services" />
				<p>
				  You can have an overview of the content of the BioCatalogue by <em>browsing our registry</em> and 
				  sorting or filtering down the list of Web Services registered.
				</p>
				<div class="center" style="height: 70px;">
				  <%= link_to image_tag("browse_web_services_button.png", :alt => "Browse Web Services"), services_path %>
				</div>
				<!-- CONTENT END -->
      </div>
      <div class="bottom"><span></span></div>
    </div>

    <div class="liquid-round" style="width: 260px; margin-top: 3em;">
      <div class="top"><span></span></div>
      <div class="center-content" style="height: 16em;">
				<!-- CONTENT BEGIN -->
				<img class="round_box_title" src="images/register_title.gif" alt="Register a Web Services" />
				<p>
				  You can easily <em>register Web Services</em> in the BioCatalogue, making them instantly available
				  to the scientific community as well as the tool developers.
				</p>
				<div class="center">
				  <%= link_to image_tag("register_web_services_button.png", :alt => "Register Web Services"), new_service_path %>
				</div>
				<br />
				<p style="font-size: 85%;">
				  To register a Web Service you will need to <%= link_to 'sign in', "/login", :id => "login_link", :class => "login" -%> first.
				</p>
				<!-- CONTENT END -->
      </div>
      <div class="bottom"><span></span></div>
    </div>
  </div>

</div>
